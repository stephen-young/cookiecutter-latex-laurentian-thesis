\documentclass[openany, 12pt]{book}

\usepackage{import}
\usepackage{titling}
\usepackage[letterpaper, margin=1in]{geometry}
\usepackage{setspace}
\usepackage[intoc]{nomencl}
\usepackage{newfloat}
\usepackage[page,toc]{appendix}
\usepackage{tocloft}
\usepackage{fancyhdr}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage{titlesec}
\usepackage{caption}

% TODO Move settings to separate file

\newcommand{\givenname}{ {{-cookiecutter.given_name-}} }
\newcommand{\surname}{ {{-cookiecutter.surname-}} }
\newcommand{\program}{ {{-cookiecutter.program-}} }
\newcommand{\programdegree}{ {{-cookiecutter.degree-}} }
\newcommand{\degreeAbbr}{ {{-cookiecutter.degree_abbreviation-}} }
\newcommand{\dateofdefence}{\today}
\title{ {{-cookiecutter.thesis_title-}} }
\author{\givenname\ \surname}

% Paragraph settings
\setlength{\parindent}{0pt}
\setlength{\parskip}{12pt}
\setlength{\headheight}{14.5pt}
\addtolength{\topmargin}{-2.5pt}

% Chapter display style
\newcommand{\titlefont}{\bfseries\Large}
\titleformat{\chapter}[display]{\titlefont}{\centering\chaptertitlename{} \thechapter}{0ex}{}[]
\titlespacing*{\chapter}{0pt}{0pt}{0pt}

% Page style settings
\fancypagestyle{frontmatter}{
    \fancyhf{}
    \fancyfoot[C]{\thepage}
    \renewcommand{\headrulewidth}{0pt}
    \renewcommand{\footrulewidth}{0pt}
}
\fancypagestyle{plain}{
    \fancyhf[R]{\thepage}
    \fancyfoot{}
    \renewcommand{\headrulewidth}{0pt}
    \renewcommand{\footrulewidth}{0pt}
}
\tocloftpagestyle{frontmatter}

% Table of contents settings
\renewcommand{\contentsname}{Table of Contents}
\renewcommand{\cfttoctitlefont}{\hfill\titlefont}
\renewcommand{\cftaftertoctitle}{\hfill}
\renewcommand{\cftchapfont}{\normalsize}
\renewcommand{\cftchappagefont}{\normalsize}
\renewcommand{\cftchappresnum}{\chaptername{}~}
\renewcommand{\cftchapleader}{\cftdotfill{\cftdotsep}}
\setlength{\cftaftertoctitleskip}{1.5em}
\setlength{\cftchapnumwidth}{2.5cm}
\newlength{\entrysep}
\setlength{\entrysep}{6pt}
\setlength{\cftbeforechapskip}{\entrysep}
\setlength{\cftbeforesecskip}{\entrysep}
\setlength{\cftbeforesubsecskip}{\entrysep}

% List of tables settings
{%- raw %}
\newcommand*{\loftvspace}[1]{
    \renewcommand*{\addvspace}[1]{\vspace{#1}}
}
{%- endraw %}
\renewcommand{\cftlottitlefont}{\hfill\titlefont}
\renewcommand{\cftafterlottitle}{\hfill}
\renewcommand{\cfttabpresnum}{Table~}
\renewcommand{\cfttabaftersnum}{:}
\setlength{\cftafterlottitleskip}{1.5em}
\setlength{\cfttabnumwidth}{2.0cm}
\setlength{\cftbeforetabskip}{\entrysep}
\addtocontents{lot}{\protect\loftvspace{0pt}}

% List of figures settings
\renewcommand{\cftloftitlefont}{\hfill\titlefont}
\renewcommand{\cftafterloftitle}{\hfill}
\renewcommand{\cftfigpresnum}{Figure~}
\renewcommand{\cftfigaftersnum}{:}
\setlength{\cftafterloftitleskip}{1.5em}
\setlength{\cftfignumwidth}{2.2cm}
\setlength{\cftbeforefigskip}{\entrysep}
\addtocontents{lof}{\protect\loftvspace{0pt}}

{% if cookiecutter.include_plates == 'y' -%}
% Plates environment and list of plates settings
\newlistof{plate}{lop}{\listplatename}
\DeclareFloatingEnvironment[
    fileext=lop,
    name=Plate,
    placement=tbhp,
    within=chapter
]{plate}
\renewcommand{\listplatename}{List of Plates}
\renewcommand{\cftloptitlefont}{\hfill\titlefont}
\renewcommand{\cftafterloptitle}{\hfill}
\renewcommand{\cftplatepresnum}{Plate~}
\renewcommand{\cftplateaftersnum}{:}
\setlength{\cftafterloptitleskip}{1.5em}
\setlength{\cftplatenumwidth}{2.0cm}
\setlength{\cftbeforeplateskip}{\entrysep}
\addtocontents{lop}{\protect\loftvspace{0pt}}

{% endif -%}
% List of appendices settings
\newlistof{appendices}{loa}{\listappendixname}
\newcommand{\listappendixname}{List of Appendices}
\renewcommand{\cftloatitlefont}{\hfill\titlefont}
\renewcommand{\cftafterloatitle}{\hfill}
\renewcommand{\cftappendicespresnum}{\appendixname}
\setlength{\cftafterloatitleskip}{1.5em}
{%- raw %}
\newcommand{\newappendix}[1]{
    \chapter{#1}
    \addcontentsline{loa}{appendices}{\appendixname{} \thechapter{}: #1}
}
{%- endraw %}

% TODO optional nomenclature
\makenomenclature

\captionsetup{justification=centering,font=bf}
{% raw %}
\graphicspath{{./figures/}}
{%- endraw %}

\begin{document}

\import{./contents/}{frontmatter.tex}

\chapter{Chapter titles use the \texttt{chapter} command}

\section{First level subheading uses \texttt{section} command}

A sample table is shown in table \ref{tab:sample-table}.
I recommend using the \texttt{booktabs} package for better horizontal rule formatting.

\import{./tables/}{tab-sample-table.tex}

\subsection{Second level subheading uses \texttt{subsection} command}

\chapter{Chapter titles use the \texttt{chapter} command}

\section{First level subheading uses \texttt{section} command}

\begin{figure}
    \centering
    \includegraphics[width=3.5cm]{laurentian-university-coa.png}
    \caption{Sample figure. Use the \texttt{figure} environment for figures to automatically populate in the list of figures}
\end{figure}

\subsection{Second level subheading uses \texttt{subsection} command}

\chapter{Chapter titles use the \texttt{chapter} command}

\section{First level subheading uses \texttt{section} command}

{% if cookiecutter.include_plates == 'y' -%}
\begin{plate}
    \centering
    \includegraphics[width=3.5cm]{laurentian-university-coa.png}
    \caption{Sample plate. Use the \texttt{plate} environment for plates to automatically populate in the list of plates}
\end{plate}

{% endif -%}
\subsection{Second level subheading uses \texttt{subsection} command}

\chapter{Chapter titles use the \texttt{chapter} command}

\section{First level subheading uses \texttt{section} command}

\subsection{Second level subheading uses \texttt{subsection} command}

% TODO References section

\addtocontents{toc}{\protect\renewcommand{\protect\cftchappresnum}{\appendixname{}~}}
\begin{appendices}

    \newappendix{Sample Appendix}

\end{appendices}


\end{document}
